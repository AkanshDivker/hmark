int ovl_do_whiteout_v1(struct inode *workdir,
			      struct dentry *dentry)
{
	int err;

	err = vfs_symlink(workdir, dentry, ovl_whiteout_symlink);
	if (err)
		return err;

	err = vfs_setxattr(dentry, ovl_whiteout_xattr, "y", 1, 0);
	if (err)
		vfs_unlink(workdir, dentry, NULL);

	if (err) {
		/*
		 * There's no way to recover from failure to whiteout.
		 * What should we do?  Log a big fat error and... ?
		 */
		pr_err("overlayfs: ERROR - failed to whiteout '%s'\n",
		       dentry->d_name.name);
	}

	return err;
}
